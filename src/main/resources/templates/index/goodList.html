<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link href="/old/css/style.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/old/index/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/old/index/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/old/index/css/style.css">
    <link rel="stylesheet" type="text/css" href="/old/index/css/simple-line-icons.css">
    <link rel="stylesheet" type="text/css" href="/old/index/css/fix-style.css">
    <link rel="stylesheet" type="text/css" href="/old/index/css/main.css">
    <link rel="stylesheet" type="text/css" href="/old/css/layui.css">

    <script src="/old/js/jquery-3.4.1.js" ></script>
    <link href="/old/css/bootstrap.css" rel="stylesheet">
    <link href="/old/css/style.css" rel="stylesheet">
    <script src="/old/js/bootstrap.js" type="text/javascript"></script>
    <link href="/old/css/layui.css" media="all" rel="stylesheet">
    <script src="/old/js/layui.js" type="text/javascript"></script>
    <!--header-->
    <style>
        .current{
            background-color: rgba(20,8,31,0.55);
        }
    </style>
</head>
<nav style="background-color:orange;" th:include="/index/header :: header"></nav>
<br>
<body>
<div id="page-container">
    <main>
        <div class="container container-240">
            <div>
                <ul class="breadcrumb v4">
                    <li><a th:href="@{/}">主页</a></li>
                    <li class="active">掌逸手机商城</li>
                </ul>
                <div>
                    <a class="image-bd effect_img2"><img src="/images/abc.jpg"  class="img-reponsive"></a>
                </div>
                <div class="pd-top">
                    <h1 class="title">商品列表</h1>
                </div>
                <div th:if="${#lists.isEmpty(goodList)}" style="padding-bottom: 40px"><h3>暂时无该商品信息，敬请期待</h3><br><a th:href="@{/}">返回商城主页</a></div>
                <div class="product-collection-grid product-grid spc1">
                    <div class="row">
                        <div class="col-xs-6 col-sm-4 col-md-4 col-lg-3 product-item" style="cursor: pointer" th:each="good:${goodList}" >
                            <div class="pd-bd product-inner" th:onclick="getGoodsDetail([[${good.id}]])">
                                <div class="product-img">
                                    <a href="#"><img style="width: 200px;height: 176px" th:src="@{${good.getImage()}}" alt="" ></a>
                                </div>
                                <div class="product-info">
                                    <div>
                                        <p class="product-title">[[${good.getName()}]]</p>
                                        <h4 class="product-title">[[${good.getSku()}]]</h4>
                                        <div class="product-bottom">
                                            <div class="product-price"><span>[[${good.getPrice()}]] 元</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="product-button-group">
                                <a th:onclick="cartGoods([[${good.id}]])" class="btn-icon">
                                    <span class="icon-handbag f-22"></span>
                                </a>
                                <a th:onclick="collectGoodsById([[${good.id}]])" class="btn-icon">
                                    <span class="icon-heart f-22"></span>
                                </a>
                                <a th:onclick="getGoodsDetail([[${good.id}]])" class="btn-icon btn-view">
                                    <span class="icon-eye f-22"></span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

</div>

<script src="/old/js/jquery-3.4.1.js" ></script>
<script src="/lib/layui-v2.5.5/layui.js" charset="utf-8"></script>
<script src="/js/lay-config.js?v=2.0.0" charset="utf-8"></script>
<script>

    layui.use(['layer'],function () {
        var layer = layui.layer;

        getGoodsDetail = function(goodsId){
            window.location.href="/good/getGoodDetail?goodId="+goodsId;
        }

        $("#logout").click(function () {
            layer.open({
                title:'提示',
                type:1,
                offset:'auto',
                content:'<div style="padding: 20px 60px;font-size: 15px">'+ '您是否确定注销登录?' +'</div>',
                btn:['确定','取消'],
                btnAlign:'c',
                shade:0,
                yes:function () {
                    $.ajax({
                        type:"get",
                        url:"/user/logout",
                        success:function(data){
                            if (data.code == 200){
                                window.location.href="/userLogin";
                            }else {
                                layer.msg("注销登录失败",{icon:5});
                            }
                        },
                        error:function () {
                            layer.msg("请求失败",{icon:5});
                        }
                    });
                },
                btn2:function () {
                    layer.closeAll();
                }

            });
        });
    });
    collectGoodsById = function (goodId) {
        $.ajax({
            type:"post",
            url:"/collect/add",
            data : {
                goodId : goodId,
            },
            success:function (data) {
                if (data.code == 200){
                    layer.msg("已将该商品加入收藏夹",{icon:1,time:1000, shade:0.4});
                } else {
                    layer.msg(data.msg, {icon:2, time:1500, shade:0.4})
                }
            }
        });
    }
    $("#test>li").mouseenter(function () {
        $(this).addClass("current");
    });
    $("#test>li").mouseleave(function () {
        $(this).removeClass("current");
    })
    var getGoodsById = function (goodsId) {
        window.location.href="/goods/getGoodsById/"+goodsId;
    }

    /*加入购物车*/
    function cartGoods(id) {
        $.ajax({
            type:"post",
            url:"/cart/add",
            data: {
                goodId : id
            },
            success:function (data) {
                if (data.code == 200){
                    layer.msg("已加入购物车",{icon:1,time:1000, shade:0.4});
                } else {
                    layer.msg(data.msg, {icon:2, time:1500, shade:0.4})
                }
            },
            error:function (data) {
                layer.msg("请求失败");
            }
        })
    }


</script>
</body>
</html>
